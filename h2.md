# OWASP: OWASP Top 10: Broken Access Control

## Yleisesti

- Broken Access Control haavoittuvuus: 94 % sovelluksista testattiin ja sitä esiintyi n. 3,81 %

Yleisiä CWE-kategorioita: (Common Weakness Enumeratons = Yleisten Heikkouksien Luetteloita)
- CWE‑200: luvattomalle paljastettu tieto
- CWE‑201: arkaluonteisen tiedon lisääminen lähetettyyn dataan
- CWE‑352: Cross-Site Request Forgery (CSRF)

## Kuvaus
- Broken Access Control tarkoittaa tilanteita, jossa käyttäjä voi tehdä asioita, joihin ei ole oikeutta
- Voi johtaa tietoihin käsiksi pääsemiseen, tietojen muokkaamiseen tai sovelluksen toimintojen väärinkäyttöön
### Yleisiä ongelmia:
- Least privilege/deny by default-periaatteen rikkominen: käyttäjille annetaan liikaa oikeuksia
- Pääsynvalvonnan ohittaminen: Muun muassa URL-muokkauksella, parametreilla tai muokkaamalla API-pyyntöjä
- IDOR (Insecure Direct Object Reference): toinen käyttäjä voi nähdä tai muokata jonkun toisen tietoja muuttamalla ID‑arvoa
- Puutteelliset käyttöoikeudet API-kutsuissa (POST, PUT, DELETE).
- Privilege escalation: käyttäjä voi toimia ilman kirjautumista tai adminina ilman admin-oikeuksia
- Metadatan manipulointi (JWT, cookie, piilokentät).
- CORS-virheelliset asetukset: luvattomat ulkopuoliset origin‑osoitteet voivat tehdä pyyntöjä.
- Force browsing: käyttäjä voi päästä sivuille ilman tarvittavia tunnuksia.

## Ehkäisy
- Tee käyttöoikeustarkistukset vain palvelinpuolella
- Deny by default eli anna oikeudet vain erikseen
- Käytä yhtenäisiä access control-mekanismeja koko sovelluksessa.
- Mallinna oikeudet tietuekohtaisesti (record ownership) ei vain CRUD-oikeuksina
- Poista hakemistolistaukset ja varmistuksien näkyvyys web-juuressa
- Kirjaa ja hälytä toistuvista epäonnistuneista pääsyyrityksistä
- Rate limit API‑kutsut
- Invalidoi sessiot asianmukaisesti
- Tee yksikkö- ja integraatiotestit myös käyttöoikeuslogiikalle

Lähde: OWASO.org. 2021. A01:2021 – Broken Access Control. Luettavissa: https://owasp.org/Top10/2021/A01_2021-Broken_Access_Control/index.html. Luettu: 19.1.2026.

# Find Hidden Web Directories - Fuzz URLs with ffuf
- Verkkopalvelimmilla voi olla piilotettuja tai linkittämättömiä hakemistoja(/secret, /.svn/admin.)
- Niiden etsiminen käsin on hidasta, kannattaa käyttää automaattista työkalua
- ffuf on on nopea ja joustava web-fuzzeri, jonka tarkoitus on kokeilla automaattisesti monia URL‑polkuja
- ffufilla voi fuzzata myös muita asioita kuin hakemistoja
- Käyttö vaatii lailliset oikeudet ja luvat testausta varten
- Harjoittelu kannattaa tehdä paikallisesti ja ilman internetiä (to avoid leaking packets to the Internet)

Lähde: Karvinen, T. 2023. Find Hidden Web Directories - Fuzz URLs with ffuf. Luettavissa: https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/. Luettu: 19.1.2026.

# PortSwigger



